---
title: Description de l'API Live Catch-up : Cette rubrique explique comment créer une tâche en direct avec rattrapage à l'aide de l'API de rattrapage en direct (TimeShift).
parent: Guides 
grandparent: Live API
layout: staging
---
 <h1>{{ page.title }}</h1>
<article class="bcls-article">
  <summary>{{ page.description }}</summary>
  <section class="bcls-section">
    <h2 id="Introduction">Introduction</h2>
    <p>L'API de rattrapage en direct est un ajout à l'API Live qui fournit une capacité de replay pour le début ou une partie d'un flux en direct pour permettre aux téléspectateurs tardifs de « rattraper ».</p>
    <p>La capacité de rattrapage est ajoutée à une tâche Live via un nouveau champ d' <code translate="No">timeshift</code> objet utilisé lors de la création d'un travail Live. Les détails des champs <code translate="No">timeshift</code> d'objet sont détaillés dans les sections ci-dessous.</p>
  </section>
  <section class="bcls-section">
    <h2 id="timeshift_fields">Champs TimeShift</h2>
    <p>L' <code translate="No">timeshift</code> objet est un objet de niveau supérieur dans le corps de la requête pour créer une demande de travail dynamique. Le tableau ci-dessous détaille les champs de cet objet.</p>
    <table class="bcls-table">
      <caption class="bcls-caption--table"><code translate="No">timeshift</code> Champs</caption>
      <thead class="bcls-table__head">
          <tr>
              <th>Champ</th>
              <th>Description</th>
          </tr>
      </thead>
      <tbody class="bcls-table__body">
          <tr>
              <td><code translate="No">startover_duration</code></td>
              <td>
                Taille de la fenêtre de démarrage en quelques secondes, jusqu'à 604800 (7 jours).
                <p>Si <code translate="No">timeshift.startover_duration</code> est spécifié dans la requête, une URL de lecture avec décalage temporel sera créée pour chaque playlist. Ces URL prendront en charge la lecture de bord en direct (avec une taille DVR spécifiée par le <code translate="No">live_duration</code> paramètre).</p>
                <p>Ils prendront également en charge la lecture de portions arbitraires dans la période définie par startover_duration en ajoutant des paramètres :</p>
                <ul style="padding: 0;margin-left: 1rem;">
                  <li><code translate="No">start=ts</code>- Horodatage Unix Epoch du début de la lecture</li>
                  <li><code translate="No">end=ts</code>- Horodatage Unix époque de la fin de lecture</li>
                </ul>
              </td>
          </tr>
          <tr>
              <td><code translate="No">live_duration</code></td>
              <td>Taille de la fenêtre en direct en quelques secondes jusqu'à 300. La valeur par défaut est 4 x durée de segment.</td>
          </tr>
          <tr>
              <td><code translate="No">live_delay</code></td>
              <td>Nombre de secondes pour retarder la sortie en direct. La valeur minimale et la valeur par défaut sont de 5 secondes.</td>
          </tr>
          <tr>
              <td><code translate="No">type</code></td>
              <td>
                <ul style="padding: 0;margin-left: 1rem;">
                  <li>single - pour une tâche de travail temporel autonome (par défaut)</li>
                  <li>primaire - pour le poste de travail principal (doit être un emploi <a href="/live-api/guides/live-api-static-entry-points.html">SEP</a>)</li>
                  <li>sauvegarde - pour une tâche de sauvegarde temporelle</li>
                </ul>
              </td>
          </tr>
          <tr>
              <td><code translate="No">primary_job_id</code></td>
              <td>Référence l'ID de travail de décalage horaire principal (requis si le type est sauvegarde).</td>
          </tr>
          <tr>
              <td><code translate="No">skip_live_output</code></td>
              <td>Ne générez pas de playlists live ou dvr normales (la valeur par défaut est false)</td>
          </tr>
      </tbody>
  </table>
  <h3>Remarques</h3>
  <ul>
    <li>Notez que les URL temporel ne sont pas incluses dans la réponse de l'API si timeshift.type est « backup ». Utilisez les URL de déviation de temps signalées pour la tâche principale.</li>
    <li>Si la DRM est requise pour une sortie de décalage temporel, incluez un <code translate="No">drm</code> champ dans la demande de travail comme d'habitude. Cet attribut doit uniquement être spécifié pour la tâche principale afin de protéger la sortie du décalage temporel. Toutefois, il peut être souhaitable de définir skip_live_output sur true pour les tâches de sauvegarde afin d'empêcher la lecture non protégée.</li>
    <li>L'écrêtage est limité aux dernières 24 heures, et comme la redondance en direct, inclut uniquement les entrées de la tâche sélectionnée</li>
  </ul>
  </section>
  <section class="bcls-section">
    <h2 id="Sample_request_body">Exemple</h2>
    <h3>Corps de la requête</h3>
<pre class="line-numbers"><code class="language-json" translate="No">{
  "live_stream": true,
  "region": "us-west-2",
  "reconnect_time": 300,
  "ad_insertion": false,
  "static": false,
  <span class="bcls-highlight">"timeshift": {
    "startover_duration": 36000,
    "type": "single",
    "live_delay": 20,
    "skip_live_output": true
  },</span>
  "drm":{"modes":["fairplay","widevine:dash","playready"]},
  "outputs": [...]
}</code></pre>
    <details>
      <summary><h2>Exemple de réponse (partielle)</h2></summary>
<pre class="line-numbers"><code class="language-json" translate="No">{
  "id": "e948ae380893403eb33bb99ef48f96ca",
  "outputs": [
    {
      "id": "2-e948ae380893403eb33bb99ef48f96ca",
      "playlist_type": "defaultS3",
      "type": "playlist",
      "drm": {
        "token": "eyJhb...",
        "modes": [
            {
              "type": "fairplay",
              "key_system": "com.apple.fps.1_0",
              "license_url": "https://license-proxy-qa.alive.us-west-2.qa.deploys.brightcove.com/lic/fp?token=eyJhb…",
              "certificate_url": "https://license-proxy-qa.alive.us-west-2.qa.deploys.brightcove.com/cert/fp?token=eyJhb...",
              "filename": "playlist_fp.m3u8",
              "dvr_filename": "playlist_fp_dvr.m3u8",
              "playback_url": "https://playback-qa.a-live.io/e948ae380893403eb33bb99ef48f96ca/us-west-2/NA/playlist_fp.m3u8",
              "playback_url_dvr": "https://playback-qa.a-live.io/e948ae380893403eb33bb99ef48f96ca/us-west-2/NA/playlist_fp_dvr.m3u8",
              <span class="bcls-highlight">"timeshift_url": "https://timeshift.bcovlive-dev.com/e948ae380893403eb33bb99ef48f96ca/us-west-2/NA/8343f7014c0ea438/88575623f08e4befbc5892ed09b2042e/playlist_ts.m3u8",</span>
              "playback_added_cdns": []
            },
            {
              "type": "widevine",
              "key_system": "com.widevine.alpha",
              "license_url": "https://license-proxy-qa.alive.us-west-2.qa.deploys.brightcove.com/lic/wv?token=eyJhb...",
              "filename": "playlist.mpd",
              "dvr_filename": "playlist_dvr.mpd",
              "playback_url": "https://playback-qa.a-live.io/e948ae380893403eb33bb99ef48f96ca/us-west-2/NA/playlist.mpd",
              "playback_url_dvr": "https://playback-qa.a-live.io/e948ae380893403eb33bb99ef48f96ca/us-west-2/NA/playlist_dvr.mpd",
              <span class="bcls-highlight">"timeshift_url": "https://timeshift.bcovlive-dev.com/e948ae380893403eb33bb99ef48f96ca/us-west-2/NA/8343f7014c0ea438/324e208d72ef47f78e78f430d007a97e/playlist_ts.mpd",</span>
              "playback_added_cdns": []
            },
            {
              "type": "playready",
              "key_system": "com.microsoft.playready",
              "license_url": "https://license-proxy-qa.alive.us-west-2.qa.deploys.brightcove.com/lic/pr?token=eyJhb...",
              "filename": "playlist.mpd",
              "dvr_filename": "playlist_dvr.mpd",
              "playback_url": "https://playback-qa.a-live.io/e948ae380893403eb33bb99ef48f96ca/us-west-2/NA/playlist.mpd",
              "playback_url_dvr": "https://playback-qa.a-live.io/e948ae380893403eb33bb99ef48f96ca/us-west-2/NA/playlist_dvr.mpd",
              <span class="bcls-highlight">"timeshift_url": "https://timeshift.bcovlive-dev.com/e948ae380893403eb33bb99ef48f96ca/us-west-2/NA/8343f7014c0ea438/324e208d72ef47f78e78f430d007a97e/playlist_ts.mpd",</span>
              "playback_added_cdns": []
            }
          ],
          "token_expires_in": 43200,
          "require_playback_token": false
      }
    }
  ],
} </code></pre>
    </details>
  </section>
  <section class="bcls-section">
    <h2 id="Getting_job_info">Obtenir les détails du travail</h2>
    <p>Que vous demandiez une liste d'emplois ou des détails spécifiques, <code translate="No">timeshift_url</code> sera inclus pour n'importe quelle liste de lecture d'une tâche compatible avec le temps. L'appelant peut ajouter des paramètres à cette URL pour spécifier les heures de début et d'arrêt comme horodatages Unix Epoch. Par exemple :</p>
<pre><code class="language-http" translate="No">https://bcovlive-a.akamaihd.net/8d64308aafe34d17adb98af69e9eac13/us-east-1/6021289116001/ts-cf98fa7b2ee4450e-5df3aae6cb724fe1a4a932b4964d3e17/playlist_ts.m3u8?start=1593457200&end=1593460800</code></pre>
    <p>Si la <code translate="No">start</code> et <code translate="No">end</code> les paramètres ne sont pas inclus, la lecture se fera au bord en direct.</p>
  </section>
  <section class="bcls-section">
    <h2 id="Create_Playback_Token">Créer un jeton de lecture</h2>
    <p>De nouveaux champs ont été ajoutés au jeton de lecture pour permettre aux URL de décalage temporel d'être renvoyées par l'API Get Job Sources. Actuellement, SSAI n'est pas pris en charge pour les tâches avec décalage temporel activé, de sorte qu'un <code translate="No">application_id</code> attribut ne doit pas être spécifié.</p>
    <p>Si <code translate="No">ts_start</code> et <code translate="No">ts_end</code> sont spécifiés, ils seront ajoutés à l'URL de lecture en tant que paramètres de requête, comme décrit dans la section précédente.</p>
    <h3>Nouveaux champs</h3>
    <table class="bcls-table">
      <caption class="bcls-caption--table">Nouveaux champs de jeton de lecture</caption>
      <thead class="bcls-table__head">
          <tr>
              <th>Champ</th>
              <th>Description</th>
          </tr>
      </thead>
      <tbody class="bcls-table__body">
          <tr>
              <td><code translate="No">ts</code></td>
              <td>Sélectionner l'URL de lecture de décalage temporel (vraie|false, facultatif, la valeur par défaut est false)</td>
          </tr>
          <tr>
              <td><code translate="No">ts_start</code></td>
              <td>Horodatage Unix pour le début de la fenêtre de démarrage (nombre, facultatif)</td>
          </tr>
          <tr>
              <td><code translate="No">ts_end</code></td>
              <td>Horodatage de l'époque Unix pour la fin de la fenêtre de démarrage (nombre, facultatif)</td>
          </tr>
      </tbody>
  </table>
  </section>
</article>
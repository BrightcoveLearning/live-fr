---
title: 'Utilisation de la redondance en direct'
description: 'Les groupes redondants vous permettent de combiner 2 tâches en direct ou plus en un seul flux avec basculement automatique pour une lecture fiable et ininterrompue. Ce guide vous expliquera comment créer un groupe redondant, ajouter des tâches et forcer un basculement à l'aide de l'API Live.'
parent: Guides 
grandparent: Live API
---
 <h1>Cette page a été déplacée - vous serez dirigé vers le <a href="https://apis.support.brightcove.com/live-api/guides/using-live-redundancy.html">nouvel emplacement</a> dans 3 secondes. Veuillez mettre à jour vos signets !</h1>
<script type="text/javascript">
var t = setTimeout (function () { window.location.href = 'https://apis.support.brightcove.com/live-api/guides/using-live-redundancy.html'; }, 3000) ;
</script>
<h1>{{ page.title }}</h1>
<article class="bcls-article">
  <summary>{{ page.description }}</summary>
  <section class="bcls-section">
    <h2 id="Introduction">Introduction</h2>
    
    <p>La fonction de redondance de Brightcove Live permet d'assurer des performances fiables pour vos événements en direct en créant un flux de sauvegarde vers lequel Live basculera automatiquement dans le cas où le premier flux cesse de fonctionner.</p>
    
    <p>Notez que toutes les requêtes à l'API Live nécessitent les en-têtes suivants :</p>
    
    <table class="bcls-table">
      <caption class="bcls-caption--table">En-têtes de requête API</caption>
      <thead class="bcls-table__head">
        <tr>
          <th>Clé</th>
          <th>Montant</th>
          <th>Remarques</th>
        </tr>
      </thead>
      <tbody class="bcls-table__body">
        <tr>
          <td><code translate="No">X-API-KEY</code></td>
          <td>{your API Key}</td>
          <td>Votre clé aurait dû être fournie lors de l'ouverture de votre compte Brightcove Live</td>
        </tr>
        <tr>
          <td><code translate="No">Content-Type</code></td>
          <td>application/json</td>
          <td>Techniquement, l' <code translate="No">content-type</code> en-tête est requis uniquement pour les demandes d'écriture qui incluent un corps de requête, mais ne devrait pas nuire aux demandes de lecture.</td>
        </tr>
      </tbody>
    </table>
    </section>
    
    <section class="bcls-section">
    <h2 id="Create_your_Live_jobs">Créez vos emplois en direct</h2>
    
    <p>Pour la configuration redondante, vous devrez créer 2 ou plusieurs Jobs Brightcove Live. La seule exigence des Jobs est qu'ils soient créés avec le <strong>même</strong> <code translate="No">output</code> réglages. La façon la plus simple d'y parvenir consiste à créer une tâche avec les spécifications de sortie souhaitées, puis à utiliser le <code translate="No">copy_outputs_from_job</code> paramètre pour créer les tâches supplémentaires.</p>
    
    <p>Il n'y a aucune restriction quant aux régions où ces emplois peuvent être créés, mais il est recommandé qu'ils soient situés relativement près l'un de l'autre.</p>
    
    <p>Une fois les tâches actives créées, maintenez les ID de travail pour plus tard. Le corps de la requête que vous utiliserez pour ajouter ces tâches à un groupe redondant (voir les sections ci-dessous) ressemblera à ceci :</p>
    
    <pre class="line-numbers">
    <code class="language-json" translate="No">[
      {
        "job_id": "0b76bc73f92f46dc917bbe5061c0c633"
      },
      {
        "job_id": "0ae5a4a71dc54b3181af0f98ee407c27"
      }
    ]</code></pre>
    </section>
    
    <section class="bcls-section">
    <h2 id="Create_the_redundant_group">Créer le groupe redondant</h2>
    
    <p>Pour créer un groupe redondant, vous allez soumettre une <code translate="No">POST</code> demande à :</p>
    
    <pre>
    <code class="language-http" translate="No">https://api.bcovlive.io/v1/redundantgroups</code></pre>
    
    <p>Voici un exemple de corps de requête :</p>
    
    <pre class="line-numbers">
    <code class="language-json" translate="No">{
      "ad_insertion": true,
      "processing_regions": ["us-west-2"],
      "storage_regions": ["us-west-2", "us-east-1"],
      "label": "Test RG",
      "live_dvr_sliding_window_duration": 1800
    }</code></pre>
    
    <p>Le tableau ci-dessous contient une liste complète des champs pour le corps de la requête. Dans plusieurs cas, ces champs sont identiques aux champs utilisés pour créer un travail actif. Reportez-vous au <a href="/live-api/references/reference.html">Live API Reference</a> pour plus de détails sur les champs.</p>
    
    <table class="bcls-table">
      <caption class="bcls-caption--table">Créer des champs de groupe redondants</caption>
      <thead class="bcls-table__head">
        <tr>
          <th>Champ</th>
          <th>Type</th>
          <th>Obligatoire ?</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody class="bcls-table__body">
        <tr>
          <td><code translate="No">ad_insertion</code></td>
          <td>booléen</td>
          <td>optionnel</td>
          <td>Définir sur true si ce flux doit être activé SSAI</td>
        </tr>
        <tr>
          <td><code translate="No">add_cdns</code></td>
          <td>gamme</td>
          <td>optionnel</td>
          <td>Tableau de fournisseurs CDN supplémentaires à utiliser pour la génération de manifestes. Pour chaque CDN fourni, le manifeste sera ajouté en conséquence</td>
        </tr>
        <tr>
          <td><code translate="No">drm</code></td>
          <td>object</td>
          <td>optionnel</td>
          <td>Pas encore pris en charge</td>
        </tr>
        <tr>
          <td><code translate="No">encryption</code></td>
          <td>object</td>
          <td>optionnel</td>
          <td>Pas encore pris en charge</td>
        </tr>
        <tr>
          <td><code translate="No">label</code></td>
          <td>chaîne</td>
          <td>requis</td>
          <td>Une étiquette pour identifier le groupe</td>
        </tr>
        <tr>
          <td><code translate="No">live_dvr_sliding_window_duration</code></td>
          <td>entier</td>
          <td>optionnel</td>
          <td></td>
        </tr>
        <tr>
          <td><code translate="No">notifications</code></td>
          <td>gamme</td>
          <td>optionnel</td>
          <td>Tableau d'objets ou de chaînes de destination de notification</td>
        </tr>
        <tr>
          <td><code translate="No">processing_regions</code></td>
          <td>gamme</td>
          <td>requis</td>
          <td>Traitement des régions pour le groupe redondant. Cela permettra de déterminer quelles régions AWS généreront les manifestes. Il est recommandé de faire correspondre storage_regions et les régions dans lesquelles les travaux dynamiques sont créés.</td>
        </tr>
        <tr>
          <td><code translate="No">storage_regions</code></td>
          <td>gamme</td>
          <td>requis</td>
          <td>Les zones de stockage des morceaux de médias et des listes de lecture seront téléchargés dans S3. Recommandé ceci correspond à processing_regions et aux régions dans lesquelles les travaux en cours sont créés.</td>
        </tr>
        <tr>
          <td><code translate="No">videocloud</code></td>
          <td>object</td>
          <td>optionnel</td>
          <td>Les clients Video Cloud ont la possibilité de créer une vidéo à utiliser pour la diffusion en direct.</td>
        </tr>
      </tbody>
    </table>
    
    <p>La réponse ressemblera à ceci :</p>
    
    <pre class="line-numbers">
    <code class="language-json" translate="No">{
      "id": "481ff4cf0bf74956bc2ec6e126588080",
      "processing_regions": [
          {
              "region": "us-west-2",
              "probability": 1
          }
      ],
      "storage_regions": [
          "us-west-2",
          "us-east-1"
      ],
      "jobs": [],
      "state": "standby",
      "label": "Test RG",
      "live_dvr_sliding_window_duration": 1800,
      "status": {
          "us-west-2": null
      },
      "ad_insertion": true,
      "outputs": {
          "playback_url": "https://playback-qa.a-live.io/r481ff4cf0bf74956bc2ec6e126588080/us-west-2/NA/playlist.m3u8",
          "playback_url_dvr": "https://playback-qa.a-live.io/r481ff4cf0bf74956bc2ec6e126588080/us-west-2/NA/playlist_dvr.m3u8",
          "ssai_playback_urls": {
              "26f8470f61374e608e27af9c1b3f7ff0": {
                  "playback_url": "https://playback-qa.a-live.io/r481ff4cf0bf74956bc2ec6e126588080/us-west-2/NA/26f8470f61374e608e27af9c1b3f7ff0/playlist_ssaiM.m3u8",
                  "playback_url_dvr": "https://playback-qa.a-live.io/r481ff4cf0bf74956bc2ec6e126588080/us-west-2/NA/26f8470f61374e608e27af9c1b3f7ff0/playlist_dvr_ssaiM.m3u8",
                  "description": "House Ads - 864b84f712ae40bca1510a8052b34312",
                  "type": "ads"
              }
      }
    }</code></pre>
    </section>
    <section class="bcls-section">
      <h2 id="get_redundant_group">Obtenir des groupes redondants</h2>
      <p>Vous pouvez obtenir tous les groupes redondants en envoyant une <code translate="No">GET</code> demande à :</p>
      <pre><code class="language-http" translate="No">https://api.bcovlive.io/v1/redundantgroups</code></pre>
      <p>Vous pouvez filtrer la réponse à l'aide du <code translate="No">state</code> param. Les valeurs autorisées sont les suivantes :</p>
      <ul>
        <li><code translate="No">cancelled</code></li>
        <li><code translate="No">cancelling</code></li>
        <li><code translate="No">deleting</code></li>
        <li><code translate="No">disconnected</code></li>
        <li><code translate="No">failed</code></li>
        <li><code translate="No">finished</code></li>
        <li><code translate="No">finishing</code></li>
        <li><code translate="No">processing</code></li>
        <li><code translate="No">standby</code></li>
        <li><code translate="No">waiting</code></li>
      </ul>
      <p>Il existe également un <code translate="No">page_size</code> paramètre qui peut être défini sur un entier jusqu'à 1000. La valeur par défaut <code translate="No">page_size</code> est 10.</p>
      <p>La réponse ressemblera à ceci :</p>
<pre class="line-numbers"><code class="language-json" translate="No">{
  "redundant_groups": [
    {
      "id": "91c268a6ec5240d79a6004f4ccf0dc6f",
      "account_id": "a95ac581551b4478b27910e5675db1f8",
      "user_id": "c2691d4d039040be96c190a949d754a7",
      "processing_regions": [
        {
          "region": "us-west-2",
          "probability": 1
        }
      ],
      "storage_regions": [
        "us-west-2",
        "us-east-1"
      ],
      "jobs": [],
      "state": "standby",
      "created_at": 1594316624287,
      "updated_at": 1594316624287,
      "label": "Test Redundant Group",
      "live_dvr_sliding_window_duration": 86400,
      "status": {
        "us-west-2": null
      },
      "outputs": {
        "playback_url": "https://bcovlive-a.akamaihd.net/r91c268a6ec5240d79a6004f4ccf0dc6f/us-west-2/NA/playlist.m3u8",
        "playback_url_dvr": "https://bcovlive-a.akamaihd.net/r91c268a6ec5240d79a6004f4ccf0dc6f/us-west-2/NA/playlist_dvr.m3u8"
      }
    },
    {
      "id": "279ac36e4b4d48a3abbd3e1f98cd57aa",
      "account_id": "a95ac581551b4478b27910e5675db1f8",
      "user_id": "c2691d4d039040be96c190a949d754a7",
      "processing_regions": [
        {
          "region": "us-west-2",
          "probability": 1
        }
      ],
      "storage_regions": [
        "us-west-2",
        "us-east-1"
      ],
      "jobs": [],
      "state": "standby",
      "created_at": 1594323207015,
      "updated_at": 1594323207015,
      "label": "Test Redundant Group2",
      "live_dvr_sliding_window_duration": 86400,
      "status": {
        "us-west-2": null
      },
      "outputs": {
        "playback_url": "https://bcovlive-a.akamaihd.net/r279ac36e4b4d48a3abbd3e1f98cd57aa/us-west-2/NA/playlist.m3u8",
        "playback_url_dvr": "https://bcovlive-a.akamaihd.net/r279ac36e4b4d48a3abbd3e1f98cd57aa/us-west-2/NA/playlist_dvr.m3u8"
      }
    }
  ]
}</code></pre>
    </section>
    <section class="bcls-section">
    <h2 id="Add_live_jobs_to_the_redundant_group">Ajouter des tâches actives au groupe redondant</h2>
    
    <p>Après avoir créé un groupe redondant, vous pouvez y ajouter des tâches en envoyant une <code translate="No">POST</code> demande à :</p>
    
    <pre>
    <code class="language-http" translate="No">https://api.bcovlive.io/v1/redundantgroups/{redundant_group_id}/jobs</code></pre>
    
    <p>Les identifiants de travail en direct sont spécifiés dans le corps de la requête comme ceci :</p>
    
    <pre class="line-numbers">
    <code class="language-json" translate="No">[
      {
        "job_id": "0b76bc73f92f46dc917bbe5061c0c633"
      },
      {
        "job_id": "0ae5a4a71dc54b3181af0f98ee407c27"
      }
    ]</code></pre>
    
    <p>Il existe quelques propriétés facultatives supplémentaires pour les objets de travail. Le tableau suivant présente tous les champs :</p>
    
    <table class="bcls-table">
      <caption class="bcls-caption--table">Ajouter des champs de demande de travaux dynamiques</caption>
      <thead class="bcls-table__head">
        <tr>
          <th>Champ</th>
          <th>Type</th>
          <th>Obligatoire ?</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody class="bcls-table__body">
        <tr>
          <td><code translate="No">job_id</code></td>
          <td>chaîne</td>
          <td>requis</td>
          <td>ID de la tâche à ajouter au groupe. Si ni <code translate="No">playlist</code> ou <code translate="No">streams</code> sont spécifiés, tous <code translate="No">outputs</code> sera utilisé.</td>
        </tr>
        <tr>
          <td><code translate="No">playlist</code></td>
          <td>chaîne</td>
          <td>optionnel</td>
          <td>Libellé de la liste de lecture à utiliser comme sorties pour le flux. Si <code translate="No">playlist</code> est défini, <code translate="No">streams</code> <strong>doit</strong> être <em>indéfini</em>.</td>
        </tr>
        <tr>
          <td><code translate="No">streams</code></td>
          <td>gamme</td>
          <td>optionnel</td>
          <td>Liste des étiquettes de flux à utiliser comme sorties pour le flux. Si <code translate="No">streams</code> est défini, <code translate="No">playlist</code> <strong>doit</strong> être <em>indéfini</em>.</td>
        </tr>
      </tbody>
    </table>
    
    <p>La réponse réussie pour cette requête retournera simplement l'identifiant de groupe redondant.</p>
    </section>
    
    <section class="bcls-section">
    <h2 id="Get_Redundant_Group_Status">Obtenir l'état du groupe redondant</h2>
    
    <p>Vous pouvez obtenir le statut d'un groupe redondant en envoyant une <code translate="No">GET</code> demande à :</p>
    
    <pre>
    <code class="language-http" translate="No">https://api.bcovlive.io/v1/redundantgroups/{redundant_group_id}</code></pre>
    
    <p>La réponse ressemblera à ce qui suit :</p>
    
    <pre class="line-numbers">
    <code class="language-json" translate="No">{
      "id": "481ff4cf0bf74956bc2ec6e126588080",
      "processing_regions": [
          {
              "region": "us-west-2",
              "probability": 1
          }
      ],
      "storage_regions": [
          "us-west-2",
          "us-east-1"
      ],
      "jobs": [
          {
              "job_id": "0b76bc73f92f46dc917bbe5061c0c633",
              "streams": [
                  "hls720p",
                  "hls540p",
                  "hls360p"
              ],
              "state": "processing"
          },
          {
              "job_id": "0ae5a4a71dc54b3181af0f98ee407c27",
              "streams": [
                  "hls720p",
                  "hls540p",
                  "hls360p"
              ],
              "state": "processing"
          }
      ],
      "state": "processing",
      "created_at": 1568057414849,
      "updated_at": 1568059153017,
      "label": "Test RG",
      "live_dvr_sliding_window_duration": 1800,
      "status": {
          "us-west-2": {
              "SwitchDrift": 0,
              "Ended": false,
              "OnAir": "0b76bc73f92f46dc917bbe5061c0c633",
              "Mode": "auto",
              "InManifest": true,
              "MediaSequence": 10,
              "Healthiness": 0,
              "Duration": 4,
              "DiscontinuitySequence": 1,
              "SourceChunk": {
                  "MediaSequence": 3639,
                  "Duration": 4,
                  "DiscontinuitySequence": 0,
                  "ProgramDateTime": "2019-09-09T19:59:36Z",
                  "LiveJobID": "0b76bc73f92f46dc917bbe5061c0c633"
              },
              "UpdatedAt": "2019-09-09T19:59:46Z",
              "ProgramDateTime": "2019-09-09T19:59:36Z"
          }
      },
      "ad_insertion": true,
      "outputs": {
          "playback_url": "https://playback-qa.a-live.io/r481ff4cf0bf74956bc2ec6e126588080/us-west-2/NA/playlist.m3u8",
          "playback_url_dvr": "https://playback-qa.a-live.io/r481ff4cf0bf74956bc2ec6e126588080/us-west-2/NA/playlist_dvr.m3u8",
          "ssai_playback_urls": {
              "26f8470f61374e608e27af9c1b3f7ff0": {
                  "playback_url": "https://playback-qa.a-live.io/r481ff4cf0bf74956bc2ec6e126588080/us-west-2/NA/26f8470f61374e608e27af9c1b3f7ff0/playlist_ssaiM.m3u8",
                  "playback_url_dvr": "https://playback-qa.a-live.io/r481ff4cf0bf74956bc2ec6e126588080/us-west-2/NA/26f8470f61374e608e27af9c1b3f7ff0/playlist_dvr_ssaiM.m3u8",
                  "description": "House Ads - 864b84f712ae40bca1510a8052b34312",
                  "type": "ads"
              }
          }
      }
    }</code></pre>
    
    <p>Chaque région de traitement du groupe redondant aura son propre <code translate="No">status</code> objet, clé par région. Vous pouvez voir dans cet exemple que dans la région <code translate="No">us_west_2</code> de traitement, le <code translate="No">on_air</code> travail est <code translate="No">0b76bc73f92f46dc917bbe5061c0c633</code>.</p>
    
    <p>En guise de note, la zone <code translate="No">probability</code> associée à la zone de traitement sera toujours à ce stade <code translate="No">1</code>, mais elle est incluse dans le modèle de données pour l'avenir. améliorations qui autoriseront plusieurs régions de traitement avec des probabilités comprises entre 0 et 1, ce qui représente le pourcentage approximatif du trafic de lecture qui utilisera cette région.</p>
    </section>
    
    <section class="bcls-section">
    <h2 id="add_cuepoints">Ajout manuel de points de cueillage</h2>
    
    <p>L'ajout manuel de points de cueillage à un flux en direct avec redondance est très similaire à l'ajout de points de cueillage à un flux en direct ordinaire. Pour ce faire pour un groupe redondant, <code translate="No">POST</code> demandez :</p>
    
    <pre>
    <code class="language-http" translate="No">https://api.bcovlive.io/v1/redundantgroups/{redundant_group_id}/cuepoint</code></pre>
    
    <p>Inclure un corps de requête comme suit :</p>
    
    <pre class="line-numbers">
    <code class="language-json" translate="No">{
      "ad_server_data": {
        "subject": "wildlife"
      },
      "duration": 30,
      "timecode": "09:23:18:05"
    }</code></pre>
    
    <p>Si vous omettez le <code translate="No">timecode</code> champ, le point de cueille sera inséré immédiatement.</p>
    </section>
    
    <section class="bcls-section">
    <h2 id="Force_a_Job_failover">Forcer un basculement sur incident</h2>
    
    <p>Le basculement est géré automatiquement par le système Brightcove Live et ne nécessite aucune intervention de votre part. Si pour une raison quelconque vous voulez forcer le basculement vers une autre tâche, cependant, la façon la plus simple de le faire est simplement d'arrêter l'encodeur de la <code translate="No">on_air</code> tâche.</p>
    
    <p>Vous pouvez également forcer le basculement à l'aide de l'API en faisant une <code translate="No">PUT</code> requête à :</p>
    
    <pre>
    <code class="language-http" translate="No">https://api.bcovlive.io/v1/redundantgroups/{redundant_group_id}/switch</code></pre>
    
    <p>Le corps de la requête ressemble à ceci :</p>
    
    <pre class="line-numbers">
    <code class="language-json" translate="No">{
      "mode": "manual",
      "on_air": "0ae5a4a71dc54b3181af0f98ee407c27"
    }</code></pre>
    
    <p>Ici, <code translate="No">mode</code> sera soit <code translate="No">manual</code> ou <code translate="No">auto</code> (la valeur par défaut) et le <code translate="No">on_air</code> aura une valeur de l'un des <strong>secondaire</strong> identifiants de travail.</p>
    
    <p>Note : Une fois dans <code translate="No">manual</code> mode, le basculement automatique des travaux <strong>ne pas</strong> se produire. Vous <strong>devez</strong> rétablir le mode <code translate="No">auto</code> pour que le basculement automatique reprenne. Vous pouvez modifier la tâche On-Air sans passer au manuel en omettant le mode du corps et en ajoutant le paramètre de requête de force <code translate="No">?force=true</code> à votre requête. Cela forcera le service à changer de tâches, mais il peut revenir en arrière à tout moment s'il détecte des problèmes.</p>
    </section>
    
    <section class="bcls-section">
    <h2 id="Ending_a_redundant_stream">Fin d'un flux redondant</h2>
    
    <p>Il existe deux façons de mettre fin à votre flux redondant. De par leur conception, les groupes redondants sont implicitement <a href="/live-api/guides/live-api-static-entry-points.html">SEP</a> ruisseaux. Vous pouvez mettre un groupe redondant en <code translate="No">STANDBY</code> mode en supprimant tous les travaux du groupe redondant.</p>
    
    <p>Pour ce faire en utilisant une <code translate="No">DELETE</code> requête pour :</p>
    
    <pre>
    <code class="language-http" translate="No">https://api.bcovlive.io/v1/redundantgroups/{redundant_group_id}/jobs/{job_id}</code></pre>
    
    <p>pour chaque tâche que vous souhaitez supprimer. Notez que pour supprimer la tâche actuellement <code translate="No">on_air</code>, vous devrez ajouter le paramètre de <code translate="No">?force-true</code> requête.</p>
    
    <p>La deuxième façon de mettre fin au flux est de supprimer complètement le groupe redondant en envoyant une <code translate="No">DELETE</code> requête à :</p>
    
    <pre>
    <code class="language-http" translate="No">https://api.bcovlive.io/v1/redundantgroups/{redundant_group_id}</code></pre>
    </section>
    <section class="bcls-section">
      <h2 id="limitations">Contraintes</h2>
      <ul>
        <li>Redondance en direct <strong>ne peux pas</strong> être utilisé avec les flux en direct protégés par DRM.</li>
      </ul>
    </section>
        </article>
    
 
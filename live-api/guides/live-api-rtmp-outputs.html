---
title: 'API en direct : Sorties RTMP'
description: 'Cette rubrique explique comment générer RTMP à l'aide de l'API Live. Les sorties RTMP sont utiles lorsque vous allez diffuser en streaming sur une plateforme qui ne prend pas en charge les flux HLS Live Streams.'
parent: Guides 
grandparent: Live API
---
 <h1>Cette page a été déplacée - vous serez dirigé vers le <a href="https://apis.support.brightcove.com/live-api/guides/live-api-rtmp-outputs.html">nouvel emplacement</a> dans 3 secondes. Veuillez mettre à jour vos signets !</h1>
<script type="text/javascript">
var t = setTimeout (function () { window.location.href = 'https://apis.support.brightcove.com/live-api/guides/live-api-rtmp-outputs.html'; }, 3000) ;
</script>
<h1>{{ page.title }}</h1>
<article class="bcls-article">
  <summary>{{ page.description }}</summary>

<section class="bcls-section">
<h2 id="general_information">Informations générales</h2>

<p>Pour utiliser les sorties RTMP, veuillez prendre connaissance des</p>

<ul>
	<li>Vous devez avoir acheté des <strong>heures d'événement</strong> ou tout forfait Marketing numérique</li>
	<li>Les heures de sortie RTMP seront facturées en fonction des heures d'événement</li>
	<li>Ils sont limités à 5 sorties par travail en direct</li>
	<li>Vous pouvez définir une option <code translate="No">label</code> où l'étiquette peut choisir l'un des formats associés en sortie sélectionnés pour le flux. Si le n' <code translate="No">label</code> est pas défini, la sortie sera par défaut à la source d'entrée.</li>
	<li>Ils peuvent être utilisés avec des tâches standard et des événements récurrents (SEP).</li>
	<li>Ils peuvent être utilisés pour des événements ou des flux 24/7.</li>
	<li>Ils peuvent être démarrés et arrêtés indépendamment de n'importe quel flux en direct.</li>
	<li>Pour les travaux SEP qui ont été créés avant l'implémentation de la fonctionnalité de sortie RTMP, la fonctionnalité ne fonctionnera pas entièrement : sur l'API, elle affichera un échec même si la sortie RTMP est réellement créée. Pour obtenir de meilleurs résultats, créez un nouveau travail SEP pour utiliser la fonction de sortie RTMP.</li>
	<li>Lors de l'utilisation d'une sortie RTMP avec un travail standard (non-SEP), le flux de sortie RTMP se termine à la fin de la tâche.</li>
  <li>Les sorties RTMP <strong>prennent</strong> en charge <code translate="No">rtmps</code> les URL, et nous vous recommandons de les utiliser si la plateforme de médias sociaux les prend en charge. Notez également qu'à partir du 1er mai 2019, Facebook n'autorisera que les RTMPS.</li>
  <li>Le <strong>seul format actuel pris en charge pour les URL RTMP</strong> est <code translate="No">rtmps://host:port/application/streamName</code>.</li>
</ul>
</section>

<section class="bcls-section">
<h2 id="notifications">Notifications</h2>

<p>Vous pouvez configurer des notifications pour les <code translate="No">rtmp_output_state_changed</code> événements. Des notifications seront envoyées pour les états suivants :</p>

b<table class="bcls-table">
  <caption class="bcls-caption--table">États de sortie RTMP</caption>
  <thead class="bcls-table__head">
      <tr>
          <th>États de sortie RTMP</th>
          <th>(signalés pour les <code translate="No">rtmp_output_state_changed</code> notifications sous la forme <code translate="No">state</code>)</th>
      </tr>
  </thead>
  <tbody class="bcls-table__body">
		<tr>
			<td><code translate="No">starting</code></td>
			<td>Le flux commence.</td>
		</tr>
		<tr>
			<td><code translate="No">connected</code></td>
			<td>L'encodeur s'est connecté.</td>
		</tr>
		<tr>
			<td><code translate="No">Disconnected</code></td>
			<td>L'encodeur s'est déconnecté.</td>
		</tr>
		<tr>
			<td><code translate="No">error</code></td>
			<td>Le flux n'a pas pu se connecter.</td>
		</tr>
		<tr>
			<td><code translate="No">pending_deactivation</code></td>
			<td>Le point d'entrée a été mis en file d'attente pour le nettoyage à partir du travailleur de diffusion en continu.</td>
		</tr>
		<tr>
			<td><code translate="No">deactivation_in_progress</code></td>
			<td>Le point d'entrée se déconnecte du flux de travail.</td>
		</tr>
		<tr>
			<td><code translate="No">cancelled</code></td>
			<td>Le point d'entrée a été annulé.</td>
		</tr>
		<tr>
			<td><code translate="No">finished</code></td>
			<td>Le point d'entrée s'est terminé avec succès.</td>
		</tr>
  </tbody>
</table>

<p>Les notifications pour les sorties RTMP doivent être définies au <strong><a href="/live-api/references/reference.html#operation/CreateALiveJob">niveau de la tâche</a></strong> lorsque vous créez le travail en direct.</p>

<p>Pour voir les différentes <code translate="No">state</code> valeurs signalées pour les sorties RTMP, reportez-vous à la section <a href="/live-api/guides/live-api-notifications.html">Notifications en direct</a>.</p>
</section>

<section class="bcls-section">
<h2 id="creating_rtmp_outputs">Création de sorties RTMP</h2>

<p>Vous devrez d'abord créer un travail en direct comme vous le faites normalement, puis faire une demande supplémentaire pour créer le (s) point (s) de terminaison RTMP.</p>

<p>Remarque : il est possible dans certaines situations comme l'activation/désactivation du travail que cet appel d'API renvoie une erreur, si cela se produit, veuillez réessayer après une pause.</p>

<h3>Point de terminaison</h3>

<pre>
	<code class="language-http" translate="No">https://api.bcovlive.io/v1/jobs/{jobId}/rtmpouts</code></pre>

<h3>Méthode</h3>

<p><code translate="No">POST</code></p>

<h3>Corps de la requête</h3>

<pre class="line-numbers">
	<code class="language-json" translate="No">{
		"url": "rtmps://host:port/application/streamName",
		"output_label": "480p"
	}</code></pre>

<table class="bcls-table">
	<caption class="bcls-caption--table">Champs de corps de demande</caption>
	<thead class="bcls-table__head">
		<tr>
			<th>Nom du champ</th>
			<th>Obligatoire</th>
			<th>Type</th>
			<th>Description</th>
		</tr>
	</thead>
	<tbody class="bcls-table__body">
		<tr>
			<td><code translate="No">url</code></td>
			<td>oui</td>
			<td>chaîne</td>
			<td>L'URL de la sortie RTMP - exemple <code translate="No">rtmp://live-api-s.facebook.com:80/rtmp/my_stream</code></td>
		</tr>
		<tr>
			<td><code translate="No">output_label</code></td>
			<td>non</td>
			<td>chaîne</td>
			<td>Libellé de la sortie de la tâche à utiliser comme source pour la sortie RTMP. Omettre ce paramètre pour utiliser simplement l'entrée RTMP à la place.</td>
		</tr>
	</tbody>
</table>

<h3>Exemple de réponse</h3>

<pre class="line-numbers">
	<code class="language-json" translate="No">{
		"host": "live-api-s.facebook.com",
		"port": 80,
		"application": "rtmp",
		"streamName": "my_stream",
		"rtmp_out_id": "asdfg-lkjh"
	}</code></pre>
</section>

<section class="bcls-section">
<h2 id="get_rtmp_outputs">Obtenir des sorties RTMP</h2>

<h3>Point de terminaison</h3>

<pre>
	<code class="language-http" translate="No">https://api.bcovlive.io/v1/jobs/{jobId}/rtmpouts</code></pre>

<h3>Méthode</h3>

<p><code translate="No">GET</code></p>

<h3>Exemple de réponse</h3>

<pre class="line-numbers">
	<code class="language-json" translate="No">[
		{
			"rtmp_out_id": "asdfg-lkjh",
			"stream_start": 1538746255247,
			"connection_info": {
				"host": "a.rtmp.youtube.com",
				"port": 1935,
				"application": "live2",
				"streamName": "my_stream",
				"sessionStatus": "Active"
			}
		}
	]</code></pre>
</section>

<section class="bcls-section">
<h2 id="stop_rtmp_output">Arrêter une sortie RTMP</h2>

<h3>Point de terminaison</h3>

<pre>
	<code class="language-http" translate="No">https://api.bcovlive.io/v1/jobs/{jobId}/rtmpouts/{rtmp_out_id}/stop</code></pre>

<h3>Méthode</h3>

<p><code translate="No">PUT</code></p>

<aside class="bcls-aside bcls-aside--information">Notez que le travail doit être démarré au moins une fois pour obtenir le <code translate="No">job_id</code>.</aside>

<h3>Exemple de réponse</h3>

<pre class="line-numbers">
	<code class="language-json" translate="No">{
		"message": "RTMP out asdfg-lkjh deleted successfully"
	}</code></pre>
</section>
</article>